#RUN: llc %s -mcpu=a64fx -ffj-swp -O1  -start-before=aarch64-swpipeliner  -swpl-debug-dump-plan  -swpl-debug-ddg -swpl-debug-dump-scheduling-every-inst -o /dev/null 2>&1 | FileCheck %s

#CHECK:### from: %58:gpr64common = COPY %67:gpr64all
#CHECK:### to  : %60:gpr64common = ADDXrs %16:gpr64common, %58:gpr64common, 1, debug-location !10; /TEST/tp/testprg.c:7:14
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %60:gpr64common = ADDXrs %16:gpr64common, %58:gpr64common, 1, debug-location !10; /TEST/tp/testprg.c:7:14
#CHECK:### to  : %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### distance:0 delay:2

#CHECK:### SwplEdge: 
#CHECK:### from: %57:gpr64sp = COPY %69:gpr64all
#CHECK:### to  : %62:gpr32 = LDURHHi %57:gpr64sp, -2, debug-location !15 :: (load (s16) from %ir.36, !tbaa !11); /TEST/tp/testprg.c:7:21
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %62:gpr32 = LDURHHi %57:gpr64sp, -2, debug-location !15 :: (load (s16) from %ir.36, !tbaa !11); /TEST/tp/testprg.c:7:21
#CHECK:### to  : %63:gpr32 = MADDWrrr killed %62:gpr32, %61:gpr32, $wzr, debug-location !16; /TEST/tp/testprg.c:7:19
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### to  : %63:gpr32 = MADDWrrr killed %62:gpr32, %61:gpr32, $wzr, debug-location !16; /TEST/tp/testprg.c:7:19
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %63:gpr32 = MADDWrrr killed %62:gpr32, %61:gpr32, $wzr, debug-location !16; /TEST/tp/testprg.c:7:19
#CHECK:### to  : STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### distance:0 delay:5

#CHECK:### SwplEdge: 
#CHECK:### from: %56:gpr64sp = COPY %71:gpr64all
#CHECK:### to  : STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %57:gpr64sp = COPY %69:gpr64all
#CHECK:### to  : %64:gpr32 = LDRHHui %57:gpr64sp, 0, debug-location !26 :: (load (s16) from %ir.33, !tbaa !11); /TEST/tp/testprg.c:8:21
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %64:gpr32 = LDRHHui %57:gpr64sp, 0, debug-location !26 :: (load (s16) from %ir.33, !tbaa !11); /TEST/tp/testprg.c:8:21
#CHECK:### to  : %65:gpr32 = MADDWrrr killed %64:gpr32, %61:gpr32, $wzr, debug-location !17; /TEST/tp/testprg.c:8:19
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### to  : %65:gpr32 = MADDWrrr killed %64:gpr32, %61:gpr32, $wzr, debug-location !17; /TEST/tp/testprg.c:8:19
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %65:gpr32 = MADDWrrr killed %64:gpr32, %61:gpr32, $wzr, debug-location !17; /TEST/tp/testprg.c:8:19
#CHECK:### to  : STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### distance:0 delay:5

#CHECK:### SwplEdge: 
#CHECK:### from: %56:gpr64sp = COPY %71:gpr64all
#CHECK:### to  : STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %58:gpr64common = COPY %67:gpr64all
#CHECK:### to  : %66:gpr64sp = nuw nsw ADDXri %58:gpr64common, 2, 0, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %66:gpr64sp = nuw nsw ADDXri %58:gpr64common, 2, 0, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### to  : %67:gpr64all = COPY %66:gpr64sp, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %57:gpr64sp = COPY %69:gpr64all
#CHECK:### to  : %68:gpr64sp = ADDXri %57:gpr64sp, 4, 0, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %68:gpr64sp = ADDXri %57:gpr64sp, 4, 0, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### to  : %69:gpr64all = COPY %68:gpr64sp, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %56:gpr64sp = COPY %71:gpr64all
#CHECK:### to  : %70:gpr64sp = ADDXri %56:gpr64sp, 4, 0, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %70:gpr64sp = ADDXri %56:gpr64sp, 4, 0, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### to  : %71:gpr64all = COPY %70:gpr64sp, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %59:gpr64sp = COPY %73:gpr64all
#CHECK:### to  : %72:gpr64 = SUBSXri %59:gpr64sp, 1, 0, implicit-def $nzcv, debug-location !9; /TEST/tp/testprg.c:6:3
#CHECK:### distance:1 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %72:gpr64 = SUBSXri %59:gpr64sp, 1, 0, implicit-def $nzcv, debug-location !9; /TEST/tp/testprg.c:6:3
#CHECK:### to  : %73:gpr64all = COPY %72:gpr64, debug-location !9; /TEST/tp/testprg.c:6:3
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %71:gpr64all = COPY %70:gpr64sp, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### to  : %56:gpr64sp = COPY %71:gpr64all
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %69:gpr64all = COPY %68:gpr64sp, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### to  : %57:gpr64sp = COPY %69:gpr64all
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %67:gpr64all = COPY %66:gpr64sp, debug-location !27; /TEST/tp/testprg.c:6:17
#CHECK:### to  : %58:gpr64common = COPY %67:gpr64all
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %73:gpr64all = COPY %72:gpr64, debug-location !9; /TEST/tp/testprg.c:6:3
#CHECK:### to  : %59:gpr64sp = COPY %73:gpr64all
#CHECK:### distance:0 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### to  : STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### to  : STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %62:gpr32 = LDURHHi %57:gpr64sp, -2, debug-location !15 :: (load (s16) from %ir.36, !tbaa !11); /TEST/tp/testprg.c:7:21
#CHECK:### to  : STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %62:gpr32 = LDURHHi %57:gpr64sp, -2, debug-location !15 :: (load (s16) from %ir.36, !tbaa !11); /TEST/tp/testprg.c:7:21
#CHECK:### to  : STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### to  : %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### distance:20 delay:6

#CHECK:### SwplEdge: 
#CHECK:### from: STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### to  : %62:gpr32 = LDURHHi %57:gpr64sp, -2, debug-location !15 :: (load (s16) from %ir.36, !tbaa !11); /TEST/tp/testprg.c:7:21
#CHECK:### distance:20 delay:6

#CHECK:### SwplEdge:
#CHECK:### from: STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### to  : %64:gpr32 = LDRHHui %57:gpr64sp, 0, debug-location !26 :: (load (s16) from %ir.33, !tbaa !11); /TEST/tp/testprg.c:8:21
#CHECK:### distance:20 delay:6

#CHECK:### SwplEdge:
#CHECK:### from: STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### to  : STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %64:gpr32 = LDRHHui %57:gpr64sp, 0, debug-location !26 :: (load (s16) from %ir.33, !tbaa !11); /TEST/tp/testprg.c:8:21
#CHECK:### to  : STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: %64:gpr32 = LDRHHui %57:gpr64sp, 0, debug-location !26 :: (load (s16) from %ir.33, !tbaa !11); /TEST/tp/testprg.c:8:21
#CHECK:### to  : STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### to  : %61:gpr32 = LDRHHui killed %60:gpr64common, 193, debug-location !10 :: (load (s16) from %ir.34, !tbaa !11); /TEST/tp/testprg.c:7:14
#CHECK:### distance:20 delay:6

#CHECK:### SwplEdge: 
#CHECK:### from: STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### to  : %62:gpr32 = LDURHHi %57:gpr64sp, -2, debug-location !15 :: (load (s16) from %ir.36, !tbaa !11); /TEST/tp/testprg.c:7:21
#CHECK:### distance:20 delay:6

#CHECK:### SwplEdge: 
#CHECK:### from: STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### to  : STURHHi killed %63:gpr32, %56:gpr64sp, -2, debug-location !25 :: (store (s16) into %ir.39, !tbaa !11); /TEST/tp/testprg.c:7:12
#CHECK:### distance:20 delay:1

#CHECK:### SwplEdge: 
#CHECK:### from: STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:### to  : %64:gpr32 = LDRHHui %57:gpr64sp, 0, debug-location !26 :: (load (s16) from %ir.33, !tbaa !11); /TEST/tp/testprg.c:8:21
#CHECK:### distance:20 delay:6



#CHECK:=========================================
#CHECK:STRHHui killed %65:gpr32, %56:gpr64sp, 0, debug-location !18 :: (store (s16) into %ir.32, !tbaa !11); /TEST/tp/testprg.c:8:12
#CHECK:successor_inst : LDRHHui ( cycle:124993, latecycle:125147, delay:-154 )
#CHECK:successor_inst : LDURHHi ( cycle:124992, latecycle:125146, delay:-154 )
#CHECK:successor_inst : STURHHi ( cycle:124999, latecycle:125158, delay:-159 )
#CHECK:successor_inst : LDRHHui ( cycle:124996, latecycle:125150, delay:-154 )
#CHECK:unset (DependConstrained  ) : MADDWrrr
#CHECK: begin_cycle          : 124999
#CHECK: SIP.slot             : 999964
#CHECK: SIP.slot.calcCycle() : 124995
#CHECK: iteration_interval = 8

#CHECK:      FLA       FLB       EXA       EXB       EAGA      EAGB      PRX       BR        LSU1      LSU2      FLA_C     FLB_C     EXA_C     EXB_C     EAGA_C    EAGB_C    
#CHECK:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#CHECK:       0         0         0         0         0         0         0         LDURHHi   0         0         0         0         0         0         0         0         
#CHECK:        0         0         0         0         0         0         0         LDRHHui   0         0         0         0         0         0         0         0         
#CHECK:       0         0         MADDWrrr  0         0         0         0         0         0         0         0         0         0         0         0         0         
#CHECK:       0         0         0         0         0         0         0         STRHHui   0         0         0         0         0         0         0         0         
#CHECK:        0         0         0         0         0         0         0         LDRHHui   0         0         0         0         0         0         0         0         
#CHECK:     ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    0         0         0         0         0         0         0         0         
#CHECK:       ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    ADDXrs    0         0         0         0         0         0         0         0         
#CHECK:       0         0         0         0         0         0         0         STURHHi   0         0         0         0         0         0         0         0         

#CHECK:	(999912)	--0--		--1--		--2--		--3--		ADDXrs		--5--		--6--		--7--	
#CHECK:	(999920)	--0--		--1--		--2--		--3--		--4--		--5--		--6--		--7--	
#CHECK:	(999928)	--0--		--1--		--2--		--3--		--4--		--5--		--6--		--7--	
#CHECK:	(999936)	--0--		--1--		--2--		--3--		LDURHHi		--5--		--6--		--7--	
#CHECK:	(999944)	--0--		--1--		--2--		--3--		LDRHHui		--5--		--6--		--7--	
#CHECK:	(999952)	--0--		--1--		--2--		--3--		MADDWrrr		--5--		--6--		--7--	
#CHECK:	(999960)	--0--		--1--		--2--		--3--		STRHHui		--5--		--6--		--7--	
#CHECK:	(999968)	--0--		--1--		--2--		--3--		LDRHHui		--5--		--6--		--7--	
#CHECK:	(999976)	--0--		--1--		--2--		--3--		--4--		--5--		--6--		--7--	
#CHECK:	(999984)	--0--		--1--		--2--		--3--		--4--		--5--		--6--		--7--	
#CHECK:	(999992)	--0--		--1--		--2--		--3--		STURHHi		--5--		--6--		--7--	
#CHECK:=========================================


--- |
  ; ModuleID = '/TEST/tp/testprg.c'
  source_filename = "/TEST/tp/testprg.c"
  target datalayout = "e-m:e-i8:8:32-i16:16:32-i64:64-i128:128-n32:64-S128"
  target triple = "aarch64-unknown-linux-gnu"
  
  @b = dso_local local_unnamed_addr global [1000 x i16] zeroinitializer, align 2
  @c = dso_local local_unnamed_addr global [1000 x i16] zeroinitializer, align 2
  @a = dso_local local_unnamed_addr global [1000 x i16] zeroinitializer, align 2
  
  ; Function Attrs: nofree norecurse nounwind
  define dso_local i32 @main() local_unnamed_addr #0 !dbg !7 {
    call void @llvm.set.loop.iterations.i64(i64 12), !dbg !9
    br label %1, !dbg !9
  
  1:                                                ; preds = %1, %0
    %2 = phi i64 [ %20, %1 ], [ 2, %0 ]
    %3 = phi i64 [ 12, %0 ], [ %21, %1 ], !dbg !10
    %4 = getelementptr i8, i8* bitcast ([1000 x i16]* @b to i8*), i64 %2, !dbg !10
    %5 = bitcast i8* %4 to <16 x i16>*
    %6 = load <16 x i16>, <16 x i16>* %5, align 2, !dbg !10, !tbaa !11
    %7 = shufflevector <16 x i16> %6, <16 x i16> undef, <8 x i32> <i32 0, i32 2, i32 4, i32 6, i32 8, i32 10, i32 12, i32 14>, !dbg !10
    %8 = getelementptr i8, i8* bitcast ([1000 x i16]* @c to i8*), i64 %2, !dbg !15
    %9 = bitcast i8* %8 to <16 x i16>*
    %10 = load <16 x i16>, <16 x i16>* %9, align 2, !dbg !15, !tbaa !11
    %11 = shufflevector <16 x i16> %10, <16 x i16> undef, <8 x i32> <i32 1, i32 3, i32 5, i32 7, i32 9, i32 11, i32 13, i32 15>, !dbg !15
    %12 = mul <16 x i16> %10, %6, !dbg !16
    %13 = shufflevector <16 x i16> %12, <16 x i16> undef, <8 x i32> <i32 0, i32 2, i32 4, i32 6, i32 8, i32 10, i32 12, i32 14>, !dbg !16
    %14 = mul <8 x i16> %11, %7, !dbg !17
    %15 = getelementptr i8, i8* bitcast ([1000 x i16]* @a to i8*), i64 %2, !dbg !18
    %16 = bitcast i8* %15 to <16 x i16>*
    %17 = shufflevector <8 x i16> %13, <8 x i16> %14, <8 x i32> <i32 0, i32 1, i32 2, i32 3, i32 4, i32 5, i32 6, i32 7>, !dbg !18
    %18 = shufflevector <8 x i16> %13, <8 x i16> %14, <8 x i32> <i32 8, i32 9, i32 10, i32 11, i32 12, i32 13, i32 14, i32 15>, !dbg !18
    %19 = bitcast <16 x i16>* %16 to <8 x i16>*, !dbg !18
    call void @llvm.aarch64.neon.st2.v8i16.p0v8i16(<8 x i16> %17, <8 x i16> %18, <8 x i16>* %19), !dbg !18
    %20 = add nuw nsw i64 %2, 32
    %21 = call i64 @llvm.loop.decrement.reg.i64(i64 %3, i64 1)
    %22 = icmp ne i64 %21, 0
    br i1 %22, label %1, label %23, !llvm.loop !19
  
  23:                                               ; preds = %1
    call void @llvm.set.loop.iterations.i64(i64 4), !dbg !9
    br label %27, !dbg !9
  
  24:                                               ; preds = %27
    %25 = load i16, i16* getelementptr inbounds ([1000 x i16], [1000 x i16]* @a, i64 0, i64 500), align 2, !dbg !23, !tbaa !11
    %26 = sext i16 %25 to i32, !dbg !23
    ret i32 %26, !dbg !24
  
  27:                                               ; preds = %23, %27
    %28 = phi [1000 x i16]* [ bitcast (i16* getelementptr inbounds ([1000 x i16], [1000 x i16]* @a, i64 0, i64 194) to [1000 x i16]*), %23 ], [ %46, %27 ]
    %29 = phi [1000 x i16]* [ bitcast (i16* getelementptr inbounds ([1000 x i16], [1000 x i16]* @c, i64 0, i64 194) to [1000 x i16]*), %23 ], [ %44, %27 ]
    %30 = phi i64 [ 0, %23 ], [ %42, %27 ]
    %31 = phi i64 [ 4, %23 ], [ %47, %27 ]
    %32 = bitcast [1000 x i16]* %28 to i16*
    %33 = bitcast [1000 x i16]* %29 to i16*
    %34 = getelementptr i16, i16* getelementptr inbounds ([1000 x i16], [1000 x i16]* @b, i64 0, i64 193), i64 %30, !dbg !10
    %35 = load i16, i16* %34, align 2, !dbg !10, !tbaa !11
    %36 = getelementptr i16, i16* %33, i64 -1, !dbg !15
    %37 = load i16, i16* %36, align 2, !dbg !15, !tbaa !11
    %38 = mul i16 %37, %35, !dbg !16
    %39 = getelementptr i16, i16* %32, i64 -1, !dbg !25
    store i16 %38, i16* %39, align 2, !dbg !25, !tbaa !11
    %40 = load i16, i16* %33, align 2, !dbg !26, !tbaa !11
    %41 = mul i16 %40, %35, !dbg !17
    store i16 %41, i16* %32, align 2, !dbg !18, !tbaa !11
    %42 = add nuw nsw i64 %30, 2, !dbg !27
    %43 = getelementptr [1000 x i16], [1000 x i16]* %29, i64 0, i64 2, !dbg !27
    %44 = bitcast i16* %43 to [1000 x i16]*, !dbg !27
    %45 = getelementptr [1000 x i16], [1000 x i16]* %28, i64 0, i64 2, !dbg !27
    %46 = bitcast i16* %45 to [1000 x i16]*, !dbg !27
    %47 = call i64 @llvm.loop.decrement.reg.i64(i64 %31, i64 1), !dbg !9
    %48 = icmp ne i64 %47, 0, !dbg !9
    br i1 %48, label %27, label %24, !dbg !9, !llvm.loop !28
  }
  
  ; Function Attrs: argmemonly nounwind
  declare void @llvm.aarch64.neon.st2.v8i16.p0v8i16(<8 x i16>, <8 x i16>, <8 x i16>* nocapture) #1
  
  ; Function Attrs: noduplicate nounwind
  declare void @llvm.set.loop.iterations.i64(i64) #2
  
  ; Function Attrs: noduplicate nounwind
  declare i64 @llvm.loop.decrement.reg.i64(i64, i64) #2
  
  ; Function Attrs: nounwind
  declare void @llvm.stackprotector(i8*, i8**) #3
  
  attributes #0 = { nofree norecurse nounwind "correctly-rounded-divide-sqrt-fp-math"="false" "disable-tail-calls"="false" "frame-pointer"="non-leaf" "less-precise-fpmad"="false" "min-legal-vector-width"="0" "no-infs-fp-math"="true" "no-jump-tables"="false" "no-nans-fp-math"="true" "no-signed-zeros-fp-math"="true" "no-trapping-math"="true" "stack-protector-buffer-size"="8" "target-cpu"="a64fx" "target-features"="+aes,+crc,+crypto,+fp-armv8,+fullfp16,+lse,+neon,+ras,+rdm,+sha2,+sve,+v8.2a" "unsafe-fp-math"="true" "use-soft-float"="false" }
  attributes #1 = { argmemonly nounwind }
  attributes #2 = { noduplicate nounwind }
  attributes #3 = { nounwind }
  
  !llvm.dbg.cu = !{!0}
  !llvm.module.flags = !{!3, !4, !5}
  !llvm.ident = !{!6}
  
  !0 = distinct !DICompileUnit(language: DW_LANG_C99, file: !1, producer: "clang version 11.0.0 (git@172.16.1.70:A64FX-SWPL/llvm-project.git e68ebd01a2974a91e7aa72a3e20ea89383029cc6)", isOptimized: true, runtimeVersion: 0, emissionKind: LineTablesOnly, enums: !2, splitDebugInlining: false, nameTableKind: None)
  !1 = !DIFile(filename: "/TEST/tp/testprg.c", directory: "/TEST")
  !2 = !{}
  !3 = !{i32 7, !"Dwarf Version", i32 4}
  !4 = !{i32 2, !"Debug Info Version", i32 3}
  !5 = !{i32 1, !"wchar_size", i32 4}
  !6 = !{!"clang version 11.0.0 (git@172.16.1.70:A64FX-SWPL/llvm-project.git e68ebd01a2974a91e7aa72a3e20ea89383029cc6)"}
  !7 = distinct !DISubprogram(name: "main", scope: !1, file: !1, line: 4, type: !8, scopeLine: 4, flags: DIFlagAllCallsDescribed, spFlags: DISPFlagDefinition | DISPFlagOptimized, unit: !0, retainedNodes: !2)
  !8 = !DISubroutineType(types: !2)
  !9 = !DILocation(line: 6, column: 3, scope: !7)
  !10 = !DILocation(line: 7, column: 14, scope: !7)
  !11 = !{!12, !12, i64 0}
  !12 = !{!"short", !13, i64 0}
  !13 = !{!"omnipotent char", !14, i64 0}
  !14 = !{!"Simple C/C++ TBAA"}
  !15 = !DILocation(line: 7, column: 21, scope: !7)
  !16 = !DILocation(line: 7, column: 19, scope: !7)
  !17 = !DILocation(line: 8, column: 19, scope: !7)
  !18 = !DILocation(line: 8, column: 12, scope: !7)
  !19 = distinct !{!19, !9, !20, !21, !22}
  !20 = !DILocation(line: 9, column: 3, scope: !7)
  !21 = !{!"llvm.loop.unroll.disable"}
  !22 = !{!"llvm.loop.isvectorized", i32 1}
  !23 = !DILocation(line: 10, column: 10, scope: !7)
  !24 = !DILocation(line: 10, column: 3, scope: !7)
  !25 = !DILocation(line: 7, column: 12, scope: !7)
  !26 = !DILocation(line: 8, column: 21, scope: !7)
  !27 = !DILocation(line: 6, column: 17, scope: !7)
  !28 = distinct !{!28, !9, !20, !21, !22}

...
---
name:            main
alignment:       8
exposesReturnsTwice: false
legalized:       false
regBankSelected: false
selected:        false
failedISel:      false
tracksRegLiveness: true
hasWinCFI:       false
registers:
  - { id: 0, class: gpr64common, preferred-register: '' }
  - { id: 1, class: gpr64sp, preferred-register: '' }
  - { id: 2, class: gpr64all, preferred-register: '' }
  - { id: 3, class: gpr64all, preferred-register: '' }
  - { id: 4, class: gpr64sp, preferred-register: '' }
  - { id: 5, class: gpr64sp, preferred-register: '' }
  - { id: 6, class: gpr64common, preferred-register: '' }
  - { id: 7, class: gpr64sp, preferred-register: '' }
  - { id: 8, class: gpr64all, preferred-register: '' }
  - { id: 9, class: gpr64all, preferred-register: '' }
  - { id: 10, class: gpr64all, preferred-register: '' }
  - { id: 11, class: gpr64all, preferred-register: '' }
  - { id: 12, class: gpr64all, preferred-register: '' }
  - { id: 13, class: gpr64all, preferred-register: '' }
  - { id: 14, class: gpr32, preferred-register: '' }
  - { id: 15, class: gpr32, preferred-register: '' }
  - { id: 16, class: gpr64common, preferred-register: '' }
  - { id: 17, class: gpr64common, preferred-register: '' }
  - { id: 18, class: fpr128, preferred-register: '' }
  - { id: 19, class: fpr128, preferred-register: '' }
  - { id: 20, class: fpr128, preferred-register: '' }
  - { id: 21, class: gpr64common, preferred-register: '' }
  - { id: 22, class: gpr64common, preferred-register: '' }
  - { id: 23, class: fpr128, preferred-register: '' }
  - { id: 24, class: fpr128, preferred-register: '' }
  - { id: 25, class: fpr128, preferred-register: '' }
  - { id: 26, class: fpr128, preferred-register: '' }
  - { id: 27, class: fpr128, preferred-register: '' }
  - { id: 28, class: fpr128, preferred-register: '' }
  - { id: 29, class: fpr128, preferred-register: '' }
  - { id: 30, class: qq, preferred-register: '' }
  - { id: 31, class: gpr64common, preferred-register: '' }
  - { id: 32, class: gpr64common, preferred-register: '' }
  - { id: 33, class: gpr64sp, preferred-register: '' }
  - { id: 34, class: gpr64, preferred-register: '' }
  - { id: 35, class: gpr64all, preferred-register: '' }
  - { id: 36, class: gpr64all, preferred-register: '' }
  - { id: 37, class: gpr64all, preferred-register: '' }
  - { id: 38, class: gpr64all, preferred-register: '' }
  - { id: 39, class: gpr64all, preferred-register: '' }
  - { id: 40, class: gpr64common, preferred-register: '' }
  - { id: 41, class: gpr64common, preferred-register: '' }
  - { id: 42, class: gpr32, preferred-register: '' }
  - { id: 43, class: gpr64, preferred-register: '' }
  - { id: 44, class: gpr64common, preferred-register: '' }
  - { id: 45, class: gpr32, preferred-register: '' }
  - { id: 46, class: gpr32, preferred-register: '' }
  - { id: 47, class: gpr32, preferred-register: '' }
  - { id: 48, class: gpr32, preferred-register: '' }
  - { id: 49, class: gpr32, preferred-register: '' }
  - { id: 50, class: gpr64sp, preferred-register: '' }
  - { id: 51, class: gpr64sp, preferred-register: '' }
  - { id: 52, class: gpr64sp, preferred-register: '' }
  - { id: 53, class: gpr64, preferred-register: '' }
  - { id: 54, class: gpr64common, preferred-register: '' }
  - { id: 55, class: gpr32, preferred-register: '' }
liveins:         []
frameInfo:
  isFrameAddressTaken: false
  isReturnAddressTaken: false
  hasStackMap:     false
  hasPatchPoint:   false
  stackSize:       0
  offsetAdjustment: 0
  maxAlignment:    1
  adjustsStack:    false
  hasCalls:        false
  stackProtector:  ''
  maxCallFrameSize: 0
  cvBytesOfCalleeSavedRegisters: 0
  hasOpaqueSPAdjustment: false
  hasVAStart:      false
  hasMustTailInVarArgFunc: false
  localFrameSize:  0
  savePoint:       ''
  restorePoint:    ''
fixedStack:      []
stack:           []
callSites:       []
constants:       []
machineFunctionInfo: {}
body:             |
  bb.0 (%ir-block.0):
    successors: %bb.1(0x80000000)
  
    %14:gpr32 = MOVi32imm 12
    %13:gpr64all = SUBREG_TO_REG 0, killed %14, %subreg.sub_32
    %15:gpr32 = MOVi32imm 2
    %12:gpr64all = SUBREG_TO_REG 0, killed %15, %subreg.sub_32
    %16:gpr64common = MOVaddr target-flags(aarch64-page) @b, target-flags(aarch64-pageoff, aarch64-nc) @b
    %21:gpr64common = MOVaddr target-flags(aarch64-page) @c, target-flags(aarch64-pageoff, aarch64-nc) @c
    %31:gpr64common = MOVaddr target-flags(aarch64-page) @a, target-flags(aarch64-pageoff, aarch64-nc) @a
  
  bb.1 (%ir-block.1):
    successors: %bb.1(0x7c000000), %bb.2(0x04000000)
  
    %0:gpr64common = PHI %12, %bb.0, %2, %bb.1
    %1:gpr64sp = PHI %13, %bb.0, %3, %bb.1, debug-location !10
    %17:gpr64common = ADDXrr %16, %0, debug-location !10
    %18:fpr128 = LDRQui %17, 1, debug-location !10 :: (load 16 from %ir.5 + 16, align 2, !tbaa !11)
    %19:fpr128 = LDRQui %17, 0, debug-location !10 :: (load 16 from %ir.5, align 2, !tbaa !11)
    %20:fpr128 = UZP1v8i16 %19, %18, debug-location !10
    %22:gpr64common = ADDXrr %21, %0, debug-location !15
    %23:fpr128 = LDRQui %22, 1, debug-location !15 :: (load 16 from %ir.9 + 16, align 2, !tbaa !11)
    %24:fpr128 = LDRQui %22, 0, debug-location !15 :: (load 16 from %ir.9, align 2, !tbaa !11)
    %25:fpr128 = UZP2v8i16 %24, %23, debug-location !15
    %26:fpr128 = MULv8i16 %23, %18, debug-location !16
    %27:fpr128 = MULv8i16 %24, %19, debug-location !16
    %28:fpr128 = UZP1v8i16 killed %27, killed %26, debug-location !16
    %29:fpr128 = MULv8i16 killed %25, killed %20, debug-location !17
    %30:qq = REG_SEQUENCE killed %28, %subreg.qsub0, killed %29, %subreg.qsub1, debug-location !16
    %32:gpr64common = ADDXrr %31, %0, debug-location !18
    ST2Twov8h killed %30, killed %32, debug-location !18 :: (store 32 into %ir.19)
    %33:gpr64sp = nuw nsw ADDXri %0, 32, 0
    %2:gpr64all = COPY %33
    %34:gpr64 = SUBSXri %1, 1, 0, implicit-def $nzcv
    %3:gpr64all = COPY %34
    Bcc 1, %bb.1, implicit $nzcv
    B %bb.2
  
  bb.2 (%ir-block.23):
    successors: %bb.4(0x80000000)
  
    %39:gpr64all = COPY $xzr
    %37:gpr64all = COPY %39
    %40:gpr64common = MOVaddr target-flags(aarch64-page) @c + 388, target-flags(aarch64-pageoff, aarch64-nc) @c + 388
    %36:gpr64all = COPY %40
    %41:gpr64common = MOVaddr target-flags(aarch64-page) @a + 388, target-flags(aarch64-pageoff, aarch64-nc) @a + 388
    %35:gpr64all = COPY %41
    %42:gpr32 = MOVi32imm 4
    %38:gpr64all = SUBREG_TO_REG 0, killed %42, %subreg.sub_32
    B %bb.4, debug-location !9
  
  bb.3 (%ir-block.24):
    %54:gpr64common = ADRP target-flags(aarch64-page) @a + 1000, debug-location !23
    %55:gpr32 = LDRSHWui killed %54, target-flags(aarch64-pageoff, aarch64-nc) @a + 1000, debug-location !23 :: (dereferenceable load 2 from `i16* getelementptr inbounds ([1000 x i16], [1000 x i16]* @a, i64 0, i64 500)`, !tbaa !11)
    $w0 = COPY %55, debug-location !24
    RET_ReallyLR implicit $w0, debug-location !24
  
  bb.4 (%ir-block.27):
    successors: %bb.4(0x7c000000), %bb.3(0x04000000)
  
    %4:gpr64sp = PHI %35, %bb.2, %10, %bb.4
    %5:gpr64sp = PHI %36, %bb.2, %9, %bb.4
    %6:gpr64common = PHI %37, %bb.2, %8, %bb.4
    %7:gpr64sp = PHI %38, %bb.2, %11, %bb.4
    %44:gpr64common = ADDXrs %16, %6, 1, debug-location !10
    %45:gpr32 = LDRHHui killed %44, 193, debug-location !10 :: (load 2 from %ir.34, !tbaa !11)
    %46:gpr32 = LDURHHi %5, -2, debug-location !15 :: (load 2 from %ir.36, !tbaa !11)
    %47:gpr32 = MADDWrrr killed %46, %45, $wzr, debug-location !16
    STURHHi killed %47, %4, -2, debug-location !25 :: (store 2 into %ir.39, !tbaa !11)
    %48:gpr32 = LDRHHui %5, 0, debug-location !26 :: (load 2 from %ir.33, !tbaa !11)
    %49:gpr32 = MADDWrrr killed %48, %45, $wzr, debug-location !17
    STRHHui killed %49, %4, 0, debug-location !18 :: (store 2 into %ir.32, !tbaa !11)
    %50:gpr64sp = nuw nsw ADDXri %6, 2, 0, debug-location !27
    %8:gpr64all = COPY %50, debug-location !27
    %51:gpr64sp = ADDXri %5, 4, 0, debug-location !27
    %9:gpr64all = COPY %51, debug-location !27
    %52:gpr64sp = ADDXri %4, 4, 0, debug-location !27
    %10:gpr64all = COPY %52, debug-location !27
    %53:gpr64 = SUBSXri %7, 1, 0, implicit-def $nzcv, debug-location !9
    %11:gpr64all = COPY %53, debug-location !9
    Bcc 1, %bb.4, implicit $nzcv, debug-location !9
    B %bb.3, debug-location !9

...
